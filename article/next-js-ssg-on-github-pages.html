<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Next.js の SSG 機能で生成した静的サイトを GitHub Actions 経由で GitHub Pages に公開する | sidearrow&#x27;s note</title><meta name="description" content="Next.js の SSG 機能で生成した静的サイトを GitHub Actions 経由で GitHub Pages に公開する手順です。"/><meta name="google-site-verification" content="EG93v2coQjmLHzGm4vQ8P7fbvn4qydBByilbqc4Fb1c"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/53e7417a5b6ed417ae2c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/53e7417a5b6ed417ae2c.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-f094e29a130fd0913879.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.daa7383ad2ab2e6757c1.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.286c5ad94e4334e87283.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-785fb5453a7db2132ff6.js" as="script"/><link rel="preload" href="/_next/static/chunks/f3013900129fac922037dcbab00ee57d209137ff.5ae31a4850f647d5e278.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/article/%5BarticleId%5D-8791b7304eee48d1ecf9.js" as="script"/></head><body><div id="__next"><div style="height:100vh;display:flex;flex-direction:column"><header><nav class="py-4 border-b"><div class="container flex justify-between"><a class="no-underline" href="/">sidearrow&#x27;s note</a></div></nav></header><main style="flex-grow:1"><div class="container"><div class="markdown-body my-20"><h1>Next.js の SSG 機能で生成した静的サイトを GitHub Actions 経由で GitHub Pages に公開する</h1>
<h2>Next.js で SSG する</h2>
<ul>
<li><code>next build</code> 後に <code>next export</code> で、<code>out</code> フォルダに HTML, CSS, JS 等が出力される</li>
<li><code>package.json</code> の <code>scripts</code> に 以下あたりを追加しておく</li>
</ul>
<pre class="hljs lang-json">{
  <span class="hljs-attr">"scripts"</span>: {
    <span class="hljs-attr">"build"</span>: <span class="hljs-string">"next build &amp;&amp; next export"</span>
  }
}
</pre>
<h2>GitHub Actions の設定</h2>
<ul>
<li><code>.github/workflows</code> ディレクトリ配下に適当な名前で以下のような yml を作成</li>
<li>公開ディレクトリ直下に <code>.nojekyll</code> といったファイルがないと、<code>_next</code> ディレクトリが公開されないようなので、ビルド後に作成している</li>
<li><a href="https://github.com/sidearrow/sidearrow.github.io/blob/master/.github/workflows/deploy.yml">実際の設定ファイル</a></li>
<li>GitHub の個人アクセストークンを作成し、環境変数に設定する必要があります</li>
</ul>
<pre class="hljs lang-yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">github</span> <span class="hljs-string">pages</span>
<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">master</span>
<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">deploy:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v2.1.0</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">node-version:</span> <span class="hljs-number">12.</span><span class="hljs-string">x</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">install</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">yarn</span> <span class="hljs-string">install</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">build</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          yarn run build
          touch out/.nojekyll
</span>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">deploy</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">peaceiris/actions-gh-pages@v3.6.4</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">github_token:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.GITHUB_TOKEN</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">publish_dir:</span> <span class="hljs-string">./out</span>
</pre>
</div></div></main><footer><div class="bg-gray-100"><div class="container text-center py-12"><div class="mb-12"><div class="mb-4 font-bold">sidearrow</div><div>ソフトウェアエンジニア@大阪</div></div><div class="mb-12 flex justify-around"><div><a href="https://github.com/sidearrow" target="_blank" rel="noreferrer">GitHub</a></div><div><a href="https://twitter.com/__sidearrow" target="_blank" rel="noreferrer">Twitter</a></div></div><div class="text-sm text-gray-500">© 2020 sidearrow</div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"id":"next-js-ssg-on-github-pages","title":"Next.js の SSG 機能で生成した静的サイトを GitHub Actions 経由で GitHub Pages に公開する","description":"Next.js の SSG 機能で生成した静的サイトを GitHub Actions 経由で GitHub Pages に公開する手順です。","createdAt":"2020/09/10","updatedAt":"2021/07/11","content":"\u003ch1\u003eNext.js の SSG 機能で生成した静的サイトを GitHub Actions 経由で GitHub Pages に公開する\u003c/h1\u003e\n\u003ch2\u003eNext.js で SSG する\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003enext build\u003c/code\u003e 後に \u003ccode\u003enext export\u003c/code\u003e で、\u003ccode\u003eout\u003c/code\u003e フォルダに HTML, CSS, JS 等が出力される\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epackage.json\u003c/code\u003e の \u003ccode\u003escripts\u003c/code\u003e に 以下あたりを追加しておく\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"hljs lang-json\"\u003e{\n  \u003cspan class=\"hljs-attr\"\u003e\"scripts\"\u003c/span\u003e: {\n    \u003cspan class=\"hljs-attr\"\u003e\"build\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"next build \u0026amp;\u0026amp; next export\"\u003c/span\u003e\n  }\n}\n\u003c/pre\u003e\n\u003ch2\u003eGitHub Actions の設定\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e.github/workflows\u003c/code\u003e ディレクトリ配下に適当な名前で以下のような yml を作成\u003c/li\u003e\n\u003cli\u003e公開ディレクトリ直下に \u003ccode\u003e.nojekyll\u003c/code\u003e といったファイルがないと、\u003ccode\u003e_next\u003c/code\u003e ディレクトリが公開されないようなので、ビルド後に作成している\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/sidearrow/sidearrow.github.io/blob/master/.github/workflows/deploy.yml\"\u003e実際の設定ファイル\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eGitHub の個人アクセストークンを作成し、環境変数に設定する必要があります\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"hljs lang-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edeploy\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eto\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egithub\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epages\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003eon:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003epush:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ebranches:\u003c/span\u003e\n      \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emaster\u003c/span\u003e\n\u003cspan class=\"hljs-attr\"\u003ejobs:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003edeploy:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eruns-on:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eubuntu-latest\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003esteps:\u003c/span\u003e\n      \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003euses:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eactions/checkout@v2\u003c/span\u003e\n      \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003euses:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eactions/setup-node@v2.1.0\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003ewith:\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003enode-version:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e12.\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003ex\u003c/span\u003e\n      \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003einstall\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003erun:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eyarn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003einstall\u003c/span\u003e\n      \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ebuild\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003erun:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e|\n          yarn run build\n          touch out/.nojekyll\n\u003c/span\u003e      \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edeploy\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003euses:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epeaceiris/actions-gh-pages@v3.6.4\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003ewith:\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003egithub_token:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e${{\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003esecrets.GITHUB_TOKEN\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e}}\u003c/span\u003e\n          \u003cspan class=\"hljs-attr\"\u003epublish_dir:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e./out\u003c/span\u003e\n\u003c/pre\u003e\n","tags":[]}},"__N_SSG":true},"page":"/article/[articleId]","query":{"articleId":"next-js-ssg-on-github-pages"},"buildId":"72h1nNJaQisiXDmuFlelq","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-2473c6643d514137e5d1.js"></script><script src="/_next/static/chunks/main-f094e29a130fd0913879.js" async=""></script><script src="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/_next/static/chunks/framework.daa7383ad2ab2e6757c1.js" async=""></script><script src="/_next/static/chunks/commons.286c5ad94e4334e87283.js" async=""></script><script src="/_next/static/chunks/pages/_app-785fb5453a7db2132ff6.js" async=""></script><script src="/_next/static/chunks/f3013900129fac922037dcbab00ee57d209137ff.5ae31a4850f647d5e278.js" async=""></script><script src="/_next/static/chunks/pages/article/%5BarticleId%5D-8791b7304eee48d1ecf9.js" async=""></script><script src="/_next/static/72h1nNJaQisiXDmuFlelq/_buildManifest.js" async=""></script><script src="/_next/static/72h1nNJaQisiXDmuFlelq/_ssgManifest.js" async=""></script></body></html>